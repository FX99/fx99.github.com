<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>打开应用，观看精彩节目</title>
<style type="text/css">
* {
	padding: 0;
	margin: 0;
}
#btn {
	width: 70%;
	height: 100px;
	line-height: 100px;
	font-size: 30px;
	margin: 0 auto;
	text-align: center;
	background: pink;
	position: relative;
	top: 450px;
}
#tipsWrapper {
	width: 100%;
	height: 100%;
	position: absolute;
	top: 0;
	left: 0;
	display: none;
}
#tips {
	width: 100%;
	height: 100%;
}
#hideTips {
	position: absolute;
	top: 20px;
	left: 20px;
}
#x1, #x2 {
	width: 50px;
	border-top: 2px solid white;
}
#x1 {
	transform: rotate(45deg);
	margin-top: 25px;
}
#x2 {
	transform: rotate(-45deg);
}

</style>
<script type="text/javascript">

	var browser = {
	    versions: function () {
	        var u = navigator.userAgent, app = navigator.appVersion;
	        return {         //移动终端浏览器版本信息
	            trident: u.indexOf('Trident') > -1, //IE内核
	            presto: u.indexOf('Presto') > -1, //opera内核
	            webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
	            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
	            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
	            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
	            android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
	            iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器
	            iPad: u.indexOf('iPad') > -1, //是否iPad
	            webApp: u.indexOf('Safari') == -1 //是否web应该程序，没有头部与底部
	        };
	    }(),
	    language: (navigator.browserLanguage || navigator.language).toLowerCase()
	}

	//是否微信中打开
	function isWeiXin() {
		var ua = navigator.userAgent.toLowerCase();
		return ua.match(/MicroMessenger/i) == "micromessenger";
	}

	//是否QQ空间中打开
	function isQQ() {
		var ua = navigator.userAgent.toLowerCase();
		return ua.match(/QQ/i) == "qq";
	}

	//是否新浪微博客户端中打开
	function isWeiBo() {
		var ua = navigator.userAgent.toLowerCase();
		return ua.match(/WeiBo/i) == "weibo";
	}

	//获取url参数
	function UrlSearch() {
		var name,value;
		var str=location.href; //取得整个地址栏
		var num=str.indexOf("?")

		str = str.substr(num+1); //取得所有参数

		var arr=str.split("&"); //各个参数放到数组里

		for (var i=0; i<arr.length; i++) {
			num=arr[i].indexOf("=");
			if (num>0) {
				name=arr[i].substring(0,num);
				value=arr[i].substr(num+1);
				this[name]=value;
			}
		}
	} 

	window.onload = function() {

		var tipsWrapper = document.getElementById("tipsWrapper");
		var hideTips = document.getElementById("hideTips");
		var imgTip = document.getElementById("tips");
		var btn = document.getElementById("btn");

		var parameters = new UrlSearch();
		var scheme = parameters.scheme + "://" + "?";
		console.log(scheme);

		console.log(parameters);

		btn.onclick = function() {
			//判断是否移动端打开
			if (browser.versions.mobile) {
				if (isWeiXin() || isQQ() || isWeiBo()) {
					//若是在社交平台打开，显示提示图片
					tipsWrapper.style.display = "block";
				} else {
					//若不是在社交平台打开
					switch(parameters.shareType) {
						case "10001": 
									scheme = scheme
										   + "programID=" + parameters.programID + "&"
										   + "episodeID=" + parameters.episodeID;
									break;
						case "10002":
						case "10003":
						case "10004":
									scheme = scheme
										   + "channelID=" + parameters.channelID + "&"
										   + "startTime=" + parameters.startTime + "&"
										   + "endTime=" + parameters.endTime;
									break;
					}

					window.location.href = scheme;
					//alert(scheme);
					window.setTimeout(function () {
						//跳转到下载链接
						if (browser.versions.ios) {
							window.location.href = "";
						} else if (browser.versions.iPad) {
							window.location.href = "";
						} else if (browser.versions.android) {
							window.location.href = "";
						} else {
							window.location.href = "";
						}
					}, 500);
				}
			} else {
				tipsWrapper.style.display = "block";
			}
		}

		//关闭提示图片
		hideTips.onclick = function() {
			tipsWrapper.style.display = "none";
		}
		
	}
</script>
</head>

<body>
	<div id="container">
		<div id="btn">打开APP，观看精彩节目&gt;&gt;</div>
		<div id="tipsWrapper">
			<div id="hideTips">
				<div id="x1"></div>
				<div id="x2"></div>
			</div>
			<img src="tips.jpg" alt="请在系统浏览器中开打开该页面" id="tips" />
		</div>
	</div>
</body>
</html>
